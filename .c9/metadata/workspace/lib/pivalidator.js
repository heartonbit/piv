{"changed":false,"filter":false,"title":"pivalidator.js","tooltip":"/lib/pivalidator.js","value":"//Per\nvar PIValidator = (function (){\n    //주민번호 정규식\n    var ssnRg = /[0-9]{2}((0[1-9])|(1[0-2]))[0-3][0-9]((-?)|[ ])(-?)((-?)|[ ])[1-4][0-9]{6}/g;\n\tfunction isSSN(str){\n\t\tvar retVal = true;\n\t\tstr = str.replace ? str.replace(\"-\", \"\") : \"\"; //대쉬 제거\n\t\t\n\t\t/////////////////////////////////////////////////////\n\t\t//1. 앞자리 여섯자리가 유효한 날짜값인지 검증\n\t\t/////////////////////////////////////////////////////\n\t\t//출생세기 판별 로직\n\t\tvar cent = 2000;\n\t\tvar type = str.slice(6,7); //7번째 숫자로 검증\n\n\t\tswitch (type){\n\t\t\tcase \"9\":\n\t\t\tcase \"0\":\n\t\t\t\tcent = 1800; //1800년대 출생자\n\t\t\t\tbreak;\n\t\t\tcase \"1\":\n\t\t\t\tcent = 1900; //1900년대 출생자\n\t\t\t\tbreak;\n\t\t\tcase \"2\":\n\t\t\t\tcent = 1900; //1900년대 출생자\n\t\t\t\tbreak;\n\t\t\tcase \"3\":\n\t\t\tcase \"4\":\n\t\t\t\tcent = 2000; //2000년대 출생자\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\t//앞자리 여섯자리 YYMMDD로 생성후 Date 변환\n\t\tvar y= parseInt(str.slice(0, 2), 10) + cent;\n\t\tvar m= parseInt(str.slice(2, 4), 10)-1;\n\t\tvar d= parseInt(str.slice(4, 6), 10);\n\t\tvar date= new Date(Date.UTC(y, m, d));\n\t\t\n\t\t//Date Validate!\n\t\tretVal = date.getUTCFullYear()===y && date.getUTCMonth()===m && date.getUTCDate()===d;\n\t\t\n\t\t\n\t\t/////////////////////////////////////////////////////\n\t\t//2. 마지막 자리 Parity checked\n\t\t/////////////////////////////////////////////////////\t\t\n\t\tvar parity = 0;\n\t\tvar strs = str.slice(0,12).split('');\n\n\t\t$.each(strs, function (index, value){\n\t\t\tparity += value * (index%8 + 2);\n\t\t});\n\t\t\n\n\t\tparity = (11 - (parity%11))%10; //10은 0으로 11은 1로 간주한다.\n\n\t\t\n\t\tretVal = retVal && parity == str.slice(12,13); //패리티 검증\n\t\t\n\t\treturn retVal;\n\t}\n\t\n\treturn {\n\t\tcontainPI: function(str){\n\t\t\tvar match;\n\t\t\tvar flag = false;\n\n\t\t\t//주민번호 검증\n\t\t\twhile( match = ssnRg.exec(str)){\n\t\t\t\tflag = flag || isSSN(match[0]); //적어도 하나가 SSN일 경우 true\n\t\t\t}\n\t\t\treturn flag;\n\t\t}\n\t\t\n\t}\n    \n})();\n\n//Submit Hooking\n$(document).ready(function(){    \n    $(\"form\").submit(function(e){\n        trace($(e.target).serialize());\n    \n        if(PIValidator.containPI($(e.target).serialize())){\n            if(!window.confirm(\"주민번호로 의심되는 정보가 발견되었습니다.\\n\\n계속 진행하시겠습니까\")){\n                e.preventDefault();//실행중단!!!\n            }\n        }\n    });\n});","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":12,"column":18},"end":{"row":12,"column":18},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1416906221269}